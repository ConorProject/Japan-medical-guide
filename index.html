<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Japan Medication Import Guide</title>
    <style>
        /* General Styles */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            background-color: #f4f7f6;
            color: #333;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: #fff;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 10px;
            margin-top: 0;
        }
        /* Search Input */
        #search-input {
            width: 100%;
            padding: 15px;
            font-size: 1.2em;
            border: 2px solid #ddd;
            border-radius: 8px;
            box-sizing: border-box;
            margin-bottom: 30px;
            transition: border-color 0.3s;
        }
        #search-input:focus {
            border-color: #3498db;
            outline: none;
        }
        /* Medication Card Styles */
        .medication-card {
            border: 1px solid #e0e0e0;
            border-left-width: 5px;
            border-radius: 8px;
            margin-bottom: 20px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        .guide-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 15px 20px;
            background-color: #f9f9f9;
        }
        .medication-title h2 { margin: 0; font-size: 1.5em; }
        .medication-generic { color: #7f8c8d; }
        /* Status Badge Styles */
        .status-badge { font-weight: bold; text-align: center; }
        .status-permitted { border-left-color: #2ecc71; } /* Green */
        .status-badge.permitted { background-color: #2ecc71; color: #fff; }
        .status-restricted { border-left-color: #e67e22; } /* Orange/Red */
        .status-badge.restricted { background-color: #e67e22; color: #fff; }
        .status-prohibited { border-left-color: #c0392b; } /* Dark Red */
        .status-badge.prohibited { background-color: #c0392b; color: #fff; }
        .mhlw-psychotropic-badge { font-size: 0.7em; margin-top: 5px; opacity: 0.9; }
        /* Content Sections */
        .critical-action, .quick-facts, .threshold-info, .mhlw-psychotropic-warning {
            padding: 15px 20px;
            border-top: 1px solid #eee;
        }
        .action-title, .threshold-title, .warning-title { font-weight: bold; margin-bottom: 10px; }
        .action-steps .step-item { display: flex; align-items: flex-start; margin-bottom: 8px; }
        .action-steps .step-number { font-weight: bold; margin-right: 10px; font-size: 1.2em; }
        /* Encyclopedia Styles */
        .encyclopedia {
            display: none;
            padding: 20px;
            background-color: #fafafa;
            border-top: 2px dashed #eee;
        }
        .encyclopedia.expanded { display: block; }
        .encyclopedia-header { font-size: 1.2em; font-weight: bold; margin-bottom: 15px; }
        .encyclopedia-section { margin-bottom: 20px; }
        .encyclopedia-section h4 { border-bottom: 1px solid #ddd; padding-bottom: 5px; margin-top: 0; }
        .encyclopedia-section ul { padding-left: 20px; margin-top: 0; }
        .research-quality { font-size: 0.9em; color: #7f8c8d; border-top: 1px solid #eee; padding-top: 10px; }
        /* Toggle Button */
        .encyclopedia-toggle {
            display: block;
            width: 100%;
            text-align: center;
            padding: 10px;
            background-color: #ecf0f1;
            border: none;
            border-top: 1px solid #ddd;
            cursor: pointer;
            font-weight: bold;
            color: #2c3e50;
        }
        .encyclopedia-toggle:hover { background-color: #e0e5e8; }
    </style>
</head>
<body>

    <div class="container">
        <h1>Japan Medication Import Guide</h1>
        <p>Enter the name of your medication to check its import status. This guide is for informational purposes only and is not a substitute for official legal advice.</p>
        <input type="text" id="search-input" placeholder="Search for a medication (e.g., Tylenol, Xanax)...">
        <div id="medication-results"></div>
    </div>

    <script>
        // =============================================================================
        // MEDICATION DATABASE
        // =============================================================================
        const medications = [
            // Add your researched medication objects here.
            // Example objects below demonstrate the different classifications.
            {
                "name": "Vyvanse",
                "genericName": "Lisdexamfetamine",
                "status": "restricted", // Technically restricted as a special permit is possible
                "isStimulant": true, // Custom flag to identify stimulants
                "uniqueStory": "Considered a 'Stimulants' Raw Material', its import is governed by Japan's strictest drug laws, a legacy of a post-WWII epidemic.",
                "notes": "The import process is complex and not recommended for tourists. Consult your doctor for a non-stimulant alternative."
            },
            {
                "name": "Xanax",
                "genericName": "Alprazolam",
                "status": "permitted", // Data status is 'permitted' for small amounts
                "mhlwPsychotropicList": true, // This flag triggers the 'restricted' display
                "controlledThresholds": true,
                "importDetails": {
                    "thresholdDetails": { "permittedQuantity": "72mg" }
                },
                "uniqueStory": "A 'Cautious Gatekeeper' drug; Japan allows its import but only through a strict, documented process due to its psychotropic nature."
            },
            {
                "name": "Tramadol",
                "genericName": "Tramadol",
                "status": "permitted",
                "mhlwPsychotropicList": false,
                "controlledThresholds": false,
                "uniqueStory": "An 'International Misunderstanding'; while a controlled opioid elsewhere, Japan classifies it as a general prescription drug for import.",
                "notes": "Despite online confusion, it is NOT treated as a narcotic for import. However, as a strong painkiller, carrying prescription documentation is essential."
            },
            {
                "name": "Ventolin (Inhaler)",
                "genericName": "Salbutamol",
                "status": "permitted",
                "mhlwPsychotropicList": false,
                "notes": "The plastic inhaler itself is considered one 'set' of a medical device, which is within the personal import limit."
            },
            {
                "name": "Adderall",
                "genericName": "Amphetamine",
                "status": "prohibited",
                "isStimulant": true
            }
        ];

        // =============================================================================
        // FINAL DISPLAY FUNCTION - Includes all safety and logic enhancements
        // =============================================================================
        function displayRestrictionResults(results, container) {
            if (results.length === 0) {
                container.innerHTML = '<p>No matching medications found.</p>';
                return;
            }
            container.innerHTML = results.map(med => {
                let statusIcon, statusClass, channelRequired, declarationRequired;
                
                let finalStatus = med.status;
                if (med.status === 'permitted' && med.mhlwPsychotropicList === true) {
                    finalStatus = 'restricted';
                }
                // Handle special stimulants that are effectively prohibited for tourists
                if (med.isStimulant === true) {
                    finalStatus = med.status === 'prohibited' ? 'prohibited' : 'restricted';
                }

                switch(finalStatus) {
                    case 'prohibited':
                        statusIcon = '❌'; statusClass = 'prohibited'; channelRequired = 'N/A'; declarationRequired = 'N/A';
                        break;
                    case 'restricted':
                    case 'permit-required':
                        statusIcon = '⚠️'; statusClass = 'restricted'; channelRequired = 'Red Channel'; declarationRequired = 'Required';
                        break;
                    case 'permitted':
                        statusIcon = '✅'; statusClass = 'permitted'; channelRequired = 'Green Channel'; declarationRequired = 'Not required';
                        break;
                    default:
                        statusIcon = '❓'; statusClass = 'unknown'; channelRequired = 'Unknown'; declarationRequired = 'Unknown';
                }

                const cardId = `med-${med.name.replace(/\s+/g, '-').toLowerCase()}`;

                return `
                    <div class="medication-card ${statusClass}">
                        <div class="guide-header">
                            <div class="medication-title">
                                <h2 class="medication-name">${med.name}</h2>
                                <div class="medication-generic">${med.genericName}</div>
                            </div>
                            <div class="status-badge ${statusClass}">
                                ${statusIcon} ${finalStatus.replace('-', ' ').toUpperCase()}
                            </div>
                        </div>

                        <div class="critical-action">
                            <div class="action-title">🎯 What You Need to Do</div>
                            <div class="action-steps">${generateEnhancedCriticalAction(med, finalStatus)}</div>
                        </div>
                        
                        <div class="quick-facts">${generateEnhancedQuickFacts(med, channelRequired, declarationRequired)}</div>
                        
                        ${med.uniqueStory ? `<div class="story-hook" style="padding:15px 20px; border-top: 1px solid #eee;"><strong>The Story:</strong> ${med.uniqueStory}</div>` : ''}

                        <button class="encyclopedia-toggle" onclick="toggleEncyclopedia('${cardId}')">📚 View More Details & Notes</button>
                        <div class="encyclopedia" id="${cardId}-encyclopedia">${generateEncyclopediaContent(med)}</div>
                    </div>
                `;
            }).join('');
        }

        // =============================================================================
        // FINAL HELPER FUNCTIONS
        // =============================================================================
        function generateEnhancedCriticalAction(med, finalStatus) {
             switch(finalStatus) {
                case 'prohibited':
                    return `<div class="step-item"><div class="step-number">❌</div><div class="step-content"><strong>DO NOT BRING:</strong> This medication is classified as an illegal substance for import by tourists.</div></div>`;
                case 'restricted':
                     if (med.isStimulant) {
                        return `<div class="step-item"><div class="step-content"><strong>Requires Special Permit:</strong> A special license from the Narcotics Control Dept. is required. This complex process is not recommended for tourists. Consult your doctor for a non-stimulant alternative.</div></div>`;
                    }
                    return `
                        <div class="step-item"><div class="step-number">1</div><div class="step-content">Keep in original packaging with a copy of your prescription and a doctor's letter.</div></div>
                        <div class="step-item"><div class="step-number">2</div><div class="step-content">At the airport, you <strong>must go to the Red Channel</strong> for inspection.</div></div>
                        <div class="step-item"><div class="step-number">3</div><div class="step-content">If bringing more than the allowed limit (e.g., >1 month supply or a specific quantity limit), you must present a pre-approved <strong>import permit</strong> (Yunyukakunin-sho).</div></div>`;
                case 'permitted':
                    return `<div class="step-item"><div class="step-number">✓</div><div class="step-content">Keep in original packaging with a copy of your prescription. You may use the <strong>Green Channel</strong>.</div></div>`;
                default:
                    return `<div class="step-item"><div class="step-content">Status unclear - verify with official authorities.</div></div>`;
            }
        }
        
        function generateEnhancedQuickFacts(med, channelRequired, declarationRequired) {
            let facts = [];
            let maxQty = med.controlledThresholds && med.importDetails?.thresholdDetails?.permittedQuantity ? med.importDetails.thresholdDetails.permittedQuantity : "1-Month Supply";
            facts.push(`<div class="fact-item"><strong>Max Qty (No Permit):</strong> ${maxQty}</div>`);
            facts.push(`<div class="fact-item"><strong>Channel:</strong> ${channelRequired}</div>`);
            facts.push(`<div class="fact-item"><strong>Declaration:</strong> ${declarationRequired}</div>`);
            return facts.join('');
        }

        function generateEncyclopediaContent(med) {
            if (!med.notes) return '';
            return `
                <div class="encyclopedia-section" style="padding: 15px 20px;">
                    <h4>Notes</h4>
                    <p>${med.notes}</p>
                </div>
            `;
        }

        function toggleEncyclopedia(cardId) {
            const encyclopedia = document.getElementById(`${cardId}-encyclopedia`);
            if (encyclopedia) {
                encyclopedia.classList.toggle('expanded');
            }
        }
        
        // =============================================================================
        // DOM EVENT LISTENERS
        // =============================================================================
        document.addEventListener('DOMContentLoaded', function() {
            const searchInput = document.getElementById('search-input');
            const resultsContainer = document.getElementById('medication-results');

            // Initial display of all medications
            displayRestrictionResults(medications, resultsContainer);

            searchInput.addEventListener('input', function(e) {
                const searchTerm = e.target.value.toLowerCase().trim();
                if (searchTerm === '') {
                    displayRestrictionResults(medications, resultsContainer);
                    return;
                }
                const filteredMeds = medications.filter(med => 
                    med.name.toLowerCase().includes(searchTerm) ||
                    med.genericName.toLowerCase().includes(searchTerm)
                );
                displayRestrictionResults(filteredMeds, resultsContainer);
            });
        });
    </script>

</body>
</html>
